# TokenLense Visualizer

[![Next.js](https://img.shields.io/badge/Next.js-15+-blue.svg)](https://nextjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5+-blue.svg)](https://www.typescriptlang.org/)
[![shadcn/ui](https://img.shields.io/badge/shadcn/ui-latest-blue.svg)](https://ui.shadcn.com/)

The Visualizer component of the [TokenLense](../README.md) framework provides an interactive web interface for exploring and analyzing token attribution data generated by language models.

ðŸ”— **Project**: [Main Documentation](../README.md) | [Extractor](../extractor/ReadMe.md) | [Analyzer API](../analyzer/README.md)

ðŸ“š **Component Docs**: [API Integration](docs/api-integration.md) | [Token Visualization](docs/token-visualization.md) | [Models Page](docs/models-page.md) | [Performance Page](docs/performance-page.md)

## Features

- **Model Exploration**: Browse and select from multiple language models
- **Attribution Methods**: Visualize token relationships using various attribution techniques:
  - Attention: Visualizes attention weights between tokens
  - Input Ã— Gradient: Identifies influential input dimensions by multiplying inputs by gradients
  - Integrated Gradients: Calculates path integrals for more accurate attribution
  - Layer Gradient Ã— Activation: Identifies important layer activations
  - LIME: Uses local perturbations to approximate model behavior
  - Saliency: Uses gradient magnitude to identify impactful tokens
- **Interactive Visualizations**: Explore token relationships through:
  - Token Cloud with interactive highlighting
  - Connection visualization between related tokens
  - Background highlighting to show relationship strength
- **Performance Analysis**: Compare attribution method performance across:
  - Different models
  - Attribution methods
  - Hardware configurations
- **Comparison View**: Side-by-side comparison of attribution results between:
  - Different models using the same method
  - Different methods on the same model
  - Both different models and methods
- **Token Importance**: Analyze token importance across multiple files

## Dashboard Pages

### Models
Entry point for exploring different language models and their attribution methods. Users can select a model and then choose an attribution method to analyze.

### Performance
Comprehensive benchmarking dashboard showing execution time, tokens per second, and hardware comparisons across different attribution methods and models.

### Compare
Side-by-side comparison tool for directly contrasting how different models or attribution methods interpret the same prompt, with synchronized token selection.

### Token Importance
Global view of token importance across multiple files, showing which tokens consistently have high influence across different inputs.

## Getting Started

### Prerequisites

- Node.js 18+ and Bun (recommended) or npm
- Access to a TokenLense API instance (locally or remote)

### Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/kaiserruben/tokenlense.git
   cd tokenlense/visualizer
   ```

2. Install dependencies:
   ```bash
   bun install
   # or with npm
   npm install
   ```

3. Configure the API endpoint:
   - Create a `.env.local` file in the `visualizer` directory
   - Add `API_URL=http://your-api-endpoint` (default: http://localhost:8000)

4. Start the development server:
   ```bash
   bun run dev
   # or with npm
   npm run dev
   ```

5. Open your browser to http://localhost:3000

### Building for Production

```bash
bun run build
# or with npm
npm run build
```

## Technical Overview

- **Frontend**: Next.js 15+ with React 19+ and TypeScript
- **UI Components**: shadcn/ui component library with Tailwind CSS
- **Charts**: Recharts for performance visualizations
- **Data Fetching**: API integration with backend attribution service
- **State Management**: React hooks for component state

## Project Structure

- `/app`: Next.js app router pages
  - `/models`: Model selection pages
  - `/performance`: Performance analysis dashboard
  - `/compare`: Comparison visualization
  - `/token-importance`: Token importance analysis
- `/components`: React components
  - `/attribution`: Token visualization components
  - `/charts`: Performance visualization components
  - `/comparison`: Comparison view components
  - `/ui`: Base UI components from shadcn/ui
- `/lib`: Shared utilities
  - `api.ts`: API integration
  - `types.ts`: TypeScript type definitions
  - `utils.ts`: Shared utility functions
- `/docs`: Component and feature documentation

## Usage Flow

1. **Select a Model**: Start by choosing a language model from the homepage
2. **Choose an Attribution Method**: Select a method to analyze how tokens influence each other
3. **Explore Visualizations**: Interact with the token cloud to see relationships
   - Hover over tokens to see their influence on other tokens
   - Click tokens to lock the selection for detailed exploration
   - Adjust visualization settings to customize the view
4. **Compare Results**: Use the comparison view to contrast different models or methods
5. **Analyze Performance**: Review performance metrics to understand efficiency tradeoffs